<!doctype html><html lang=en><head><meta charset=utf-8><meta name=generator content="Hugo 0.109.0"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content><meta property="og:url" content="https://qige96.github.io/myblog/posts/review-prob-logic-nesy-lnn/"><link rel=canonical href=https://qige96.github.io/myblog/posts/review-prob-logic-nesy-lnn/><link rel=alternate type=application/atom+xml href=https://qige96.github.io/myblogindex.xml title="Blog of Ricky"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/qige96.github.io\/myblog"},"articleSection":"posts","name":"A Review of Probabilistic Logic: NeSy - LNN","headline":"A Review of Probabilistic Logic: NeSy - LNN","description":"Logical Neural Network1 is proposed by IBM in 2020. The key ideas of LNN are simple:\nExtend the truth value of logical formula from \\(\\{True, False\\}\\) to real numbers. The authors called this extended logic weighted real-value logic. Typically, when the truth values range within \\([0, 1]\\), they can serve as probabilities. For each logical formula, create a neural net, so that evaluating the truth value of a logical formula is equivalent to evaluate a neural net.","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2022","datePublished":"2022-10-09 15:01:31 \u002b0100 \u002b0100","dateModified":"2022-10-09 15:01:31 \u002b0100 \u002b0100","url":"https:\/\/qige96.github.io\/myblog\/posts\/review-prob-logic-nesy-lnn\/","keywords":[]}</script><title>A Review of Probabilistic Logic: NeSy - LNN</title><meta property="og:title" content="A Review of Probabilistic Logic: NeSy - LNN"><meta property="og:type" content="article"><meta property="og:description" content="Logical Neural Network1 is proposed by IBM in 2020. The key ideas of LNN are simple:
Extend the truth value of logical formula from \(\{True, False\}\) to real numbers. The authors called this extended logic weighted real-value logic. Typically, when the truth values range within \([0, 1]\), they can serve as probabilities. For each logical formula, create a neural net, so that evaluating the truth value of a logical formula is equivalent to evaluate a neural net."><meta name=description content="Logical Neural Network1 is proposed by IBM in 2020. The key ideas of LNN are simple:
Extend the truth value of logical formula from \(\{True, False\}\) to real numbers. The authors called this extended logic weighted real-value logic. Typically, when the truth values range within \([0, 1]\), they can serve as probabilities. For each logical formula, create a neural net, so that evaluating the truth value of a logical formula is equivalent to evaluate a neural net."><meta property="og:locale" content="en-us"><meta property="og:image" content><style>body{font-family:bree serif,sans-serif;-webkit-font-smoothing:antialiased;margin:0 20px}article{max-width:800px;margin-left:auto;margin-right:auto}a{color:#000;text-decoration:none}a:hover{font-weight:600;text-decoration:underline}.post-ads{margin:50px 0}.markdown-body{font-size:18px;max-width:100%}.markdown-body a{text-decoration:underline;text-decoration-color:#000}.markdown-body blockquote{margin:0;padding:0 1em;color:#57606a;border-left:.25em solid #d0d7de}.markdown-body pre{padding:16px;overflow:auto;border-radius:10px}.markdown-body code{padding:.2em .4em;font-size:85%;background-color:#f6f8fa;border-radius:6px}.markdown-body pre>code{padding:0;font-size:100%;background-color:inherit;border:0}.Chinese .markdown-body{line-height:200%}.site-date-catalog{font-size:2rem}.header-title{font-size:2rem;font-weight:700;margin-top:32px;font-family:bungee shade,sans-serif}.header-title a{text-decoration:none}.header-subtitle{color:#666}.header-items{margin:10px 0}.header-item{margin:0 5px}.header-line{width:100%;border-width:2px;border-color:#482936;border-style:solid none none none}.lang-switch{font-weight:600}#posts-list{min-height:600px}.posts-line{font-size:1.2rem;margin:12px 0}.posts-categories{font-size:.8rem;margin:auto;text-align:center}.posts-category{padding:3px 0;border:#000 2px solid;border-radius:5px}.site-footer{margin-top:50px}.site-footer-item{margin-right:12px}.post-content img{max-width:100%;display:block;margin-right:auto;margin-top:12px}.post-header{margin-bottom:50px}.post-title{font-size:2rem;font-weight:600}.post-tags{display:inline;font-weight:600;padding:2px 5px;margin-right:6px;border:#000 2px solid;border-radius:5px}.post-date{font-weight:800;font-style:italic}.post-author{float:right;font-weight:600}.page-content{min-height:60%}.post-content{margin-bottom:50px}.post-content p{hyphens:auto;line-height:1.8;text-justify:ideographic;margin-bottom:1em}.related-content{border-width:3px;border-style:solid;border-color:#000;padding:0 10px;margin-bottom:50px;margin-top:100px}.related-content li{margin:5px 0}.taxonomy-term{font-size:3rem}.gallery-img{text-align:center}.gallery-img span{text-align:center}.gallery-img-desc{font-size:.8em;font-weight:800}#disqus_thread{position:relative}#disqus_thread:after{content:"";display:block;height:55px;width:100%;position:absolute;bottom:0;background:#fff}@media screen and (max-width:600px){.header-title,.header-subtitle,.header-items{text-align:center}.posts-line{font-size:16px}.markdown-body{font-size:16px}.post-title{font-size:2rem}.post-content p{letter-spacing:.05em}}@media screen and (max-width:48em){.posts-category{display:none}}</style><style>.container,.container-fluid{margin-right:auto;margin-left:auto}.container-fluid{padding-right:2rem;padding-left:2rem}.row{box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 1 auto;flex:initial;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-.5rem;margin-left:-.5rem}.row.reverse{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.col.reverse{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.col-xs,.col-xs-1,.col-xs-10,.col-xs-11,.col-xs-12,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9,.col-xs-offset-0,.col-xs-offset-1,.col-xs-offset-10,.col-xs-offset-11,.col-xs-offset-12,.col-xs-offset-2,.col-xs-offset-3,.col-xs-offset-4,.col-xs-offset-5,.col-xs-offset-6,.col-xs-offset-7,.col-xs-offset-8,.col-xs-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-xs{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-xs-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-xs-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-xs-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-xs-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-xs-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-xs-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-xs-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-xs-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-xs-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-xs-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-xs-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-xs-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-xs-offset-0{margin-left:0}.col-xs-offset-1{margin-left:8.33333333%}.col-xs-offset-2{margin-left:16.66666667%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-4{margin-left:33.33333333%}.col-xs-offset-5{margin-left:41.66666667%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-7{margin-left:58.33333333%}.col-xs-offset-8{margin-left:66.66666667%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-10{margin-left:83.33333333%}.col-xs-offset-11{margin-left:91.66666667%}.start-xs{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-xs{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-xs{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-xs{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-xs{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-xs{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-xs{-ms-flex-pack:distribute;justify-content:space-around}.between-xs{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-xs{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-xs{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}@media only screen and (min-width:48em){.container{width:49rem}.col-sm,.col-sm-1,.col-sm-10,.col-sm-11,.col-sm-12,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-offset-0,.col-sm-offset-1,.col-sm-offset-10,.col-sm-offset-11,.col-sm-offset-12,.col-sm-offset-2,.col-sm-offset-3,.col-sm-offset-4,.col-sm-offset-5,.col-sm-offset-6,.col-sm-offset-7,.col-sm-offset-8,.col-sm-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-sm{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-sm-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-sm-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-sm-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-sm-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-sm-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-sm-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-sm-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-sm-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-sm-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-sm-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-sm-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-sm-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-sm-offset-0{margin-left:0}.col-sm-offset-1{margin-left:8.33333333%}.col-sm-offset-2{margin-left:16.66666667%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-4{margin-left:33.33333333%}.col-sm-offset-5{margin-left:41.66666667%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-7{margin-left:58.33333333%}.col-sm-offset-8{margin-left:66.66666667%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-10{margin-left:83.33333333%}.col-sm-offset-11{margin-left:91.66666667%}.start-sm{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-sm{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-sm{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-sm{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-sm{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-sm{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-sm{-ms-flex-pack:distribute;justify-content:space-around}.between-sm{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-sm{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-sm{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}@media only screen and (min-width:64em){.container{width:65rem}.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-offset-0,.col-md-offset-1,.col-md-offset-10,.col-md-offset-11,.col-md-offset-12,.col-md-offset-2,.col-md-offset-3,.col-md-offset-4,.col-md-offset-5,.col-md-offset-6,.col-md-offset-7,.col-md-offset-8,.col-md-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-md{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-md-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-md-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-md-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-md-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-md-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-md-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-md-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-md-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-md-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-md-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-md-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-md-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-md-offset-0{margin-left:0}.col-md-offset-1{margin-left:8.33333333%}.col-md-offset-2{margin-left:16.66666667%}.col-md-offset-3{margin-left:25%}.col-md-offset-4{margin-left:33.33333333%}.col-md-offset-5{margin-left:41.66666667%}.col-md-offset-6{margin-left:50%}.col-md-offset-7{margin-left:58.33333333%}.col-md-offset-8{margin-left:66.66666667%}.col-md-offset-9{margin-left:75%}.col-md-offset-10{margin-left:83.33333333%}.col-md-offset-11{margin-left:91.66666667%}.start-md{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-md{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-md{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-md{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-md{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-md{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-md{-ms-flex-pack:distribute;justify-content:space-around}.between-md{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-md{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-md{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}@media only screen and (min-width:75em){.container{width:76rem}.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-offset-0,.col-lg-offset-1,.col-lg-offset-10,.col-lg-offset-11,.col-lg-offset-12,.col-lg-offset-2,.col-lg-offset-3,.col-lg-offset-4,.col-lg-offset-5,.col-lg-offset-6,.col-lg-offset-7,.col-lg-offset-8,.col-lg-offset-9{box-sizing:border-box;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:none;padding-right:.5rem;padding-left:.5rem}.col-lg{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;max-width:100%}.col-lg-1{-ms-flex-preferred-size:8.33333333%;flex-basis:8.33333333%;max-width:8.33333333%}.col-lg-2{-ms-flex-preferred-size:16.66666667%;flex-basis:16.66666667%;max-width:16.66666667%}.col-lg-3{-ms-flex-preferred-size:25%;flex-basis:25%;max-width:25%}.col-lg-4{-ms-flex-preferred-size:33.33333333%;flex-basis:33.33333333%;max-width:33.33333333%}.col-lg-5{-ms-flex-preferred-size:41.66666667%;flex-basis:41.66666667%;max-width:41.66666667%}.col-lg-6{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}.col-lg-7{-ms-flex-preferred-size:58.33333333%;flex-basis:58.33333333%;max-width:58.33333333%}.col-lg-8{-ms-flex-preferred-size:66.66666667%;flex-basis:66.66666667%;max-width:66.66666667%}.col-lg-9{-ms-flex-preferred-size:75%;flex-basis:75%;max-width:75%}.col-lg-10{-ms-flex-preferred-size:83.33333333%;flex-basis:83.33333333%;max-width:83.33333333%}.col-lg-11{-ms-flex-preferred-size:91.66666667%;flex-basis:91.66666667%;max-width:91.66666667%}.col-lg-12{-ms-flex-preferred-size:100%;flex-basis:100%;max-width:100%}.col-lg-offset-0{margin-left:0}.col-lg-offset-1{margin-left:8.33333333%}.col-lg-offset-2{margin-left:16.66666667%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-4{margin-left:33.33333333%}.col-lg-offset-5{margin-left:41.66666667%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-7{margin-left:58.33333333%}.col-lg-offset-8{margin-left:66.66666667%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-10{margin-left:83.33333333%}.col-lg-offset-11{margin-left:91.66666667%}.start-lg{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;text-align:start}.center-lg{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center}.end-lg{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;text-align:end}.top-lg{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.middle-lg{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.bottom-lg{-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.around-lg{-ms-flex-pack:distribute;justify-content:space-around}.between-lg{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.first-lg{-webkit-box-ordinal-group:0;-ms-flex-order:-1;order:-1}.last-lg{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1}}</style><link rel=stylesheet href=https://qige96.github.io/myblog/css/extra.css><link href=https://qige96.github.io/myblog/index.xml rel=alternate type=application/rss+xml title="Blog of Ricky"><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css?family=Bree+Serif|Bungee+Shade" rel=stylesheet><script src=https://qige96.github.io/myblog/js/mathjax-config.js></script>
<script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.6.0/build/styles/default.min.css><script src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.6.0/build/highlight.min.js></script>
<script>hljs.highlightAll()</script></head><body><article class=post id=article><div class=row><div class=col-xs-12><div class=site-header><header><div class=header-title><a href=https://qige96.github.io/myblog/>My Sketch Pad</a></div><div class=header-subtitle></div></header><div class="row end-md center-xs header-items"></div><div class="row end-xs"></div><div class=header-line></div></div><header class=post-header><h1 class=post-title>A Review of Probabilistic Logic: NeSy - LNN</h1><div class="row post-desc"><div class=col-xs-6><time class=post-date datetime="2022-10-09 15:01:31 +0100">09 Oct 2022</time></div><div class=col-xs-6></div></div></header><div class="post-content markdown-body"><p>Logical Neural Network<a href=#fn1 class=footnote-ref id=fnref1 role=doc-noteref><sup>1</sup></a> is proposed by IBM in 2020. The key
ideas of LNN are simple:</p><ol type=1><li>Extend the truth value of logical formula from <span class="math inline">\(\{True, False\}\)</span> to real numbers. The
authors called this extended logic <em>weighted real-value logic</em>.
Typically, when the truth values range within <span class="math inline">\([0, 1]\)</span>, they can serve as
probabilities.</li><li>For each logical formula, create a neural net, so that
<strong>evaluating the truth value of a logical formula is equivalent to
evaluate a neural net</strong>.</li><li>The parameters of neural nets can be learnt through training
examples.</li></ol><p>The first and the third point is obvious, but the second point may
not be so easy to understand. How to map a logical formula to a neural
net? Here is an example. Suppose we have such 2 formulas in weighted
real-value logic. <span class="math display">\[
(Cat ⨁ Dog) → Pet
\]</span></p><p><span class="math display">\[
Whiskers ⨂ Tail ⨂ (LaserPointer → Chases)) → Cat
\]</span></p><p>Note that the 2 operators <span class="math inline">\(⨂\)</span> and
<span class="math inline">\(⨁\)</span> is analogous to <span class="math inline">\(\land\)</span> and <span class="math inline">\(\lor\)</span> in classical logic. The first
formula expresses that <em>dogs OR cats ARE pets</em>, and the second
formula says <em>something with whiskers AND a tail AND will chase a
laser pointer IS a cat</em>. The logical neural networks of these 2
formulas are shown below:</p><figure><img src=https://qige96.github.io/myblog/images/lnn-example1.png alt="LNN example"><figcaption aria-hidden=true>LNN example</figcaption></figure><p>We can learn from the example that <strong>a logical neural network
looks like the syntax tree of the formula</strong>, where the leaf nodes
(input nodes) are the atoms and the internal nodes (hidden nodes) are
operators. Of course, an LNN has something more than a syntax tree: the
edges (connections) are associated with weights,and the nodes (neurons)
are associated with activation functions, plus the corresponding bias
parameters. Thus, the LNN of the first formula <span class="math inline">\((Cat ⨁ Dog) → Pet\)</span> is equivalent to such a
function <span class="math display">\[
z_1 = ⨁(w_{11}x_{cat} + w_{12}x_{dog}, b_1)\\
z_2 = →(w_{21}z_1 + w_{22}x_{pet}, b2)
\]</span> Suppose we are given the truth value of atoms <span class="math inline">\(x_{Cat}\)</span>, <span class="math inline">\(x_{Dog}\)</span>, and <span class="math inline">\(x_{Pet}\)</span>, then we can calculate the truth
value of the formula, which is denoted by <span class="math inline">\(y_2\)</span>, by the above equations. This is
called <em>upward pass of inference</em>, because we are performing
inference from the input nodes up to the output node. Conversely, given
the truth value of atoms <span class="math inline">\(x_{Cat}\)</span>,
<span class="math inline">\(x_{Dog}\)</span> and the the truth value
<span class="math inline">\(z_2\)</span> of the whole formula, we can
derive the truth value of <span class="math inline">\(x_{Pet}\)</span>.
This is called <em>downward pass of inference</em>.</p><p>One may wonder what exactly computation do the operators <span class="math inline">\(⨁, ⨂, →\)</span> perform. These are design choices
left by the user. Users can define their own operators that mimic the
corresponding logical operators. In the paper<a href=#fn2 class=footnote-ref id=fnref2 role=doc-noteref><sup>2</sup></a>,
the authors defined the operators as: <span class="math display">\[
⨁(\boldsymbol{w}, \boldsymbol{x}, b) = a(1 - b
+ \boldsymbol{w}^\top \boldsymbol{x}) \\
⨂(\boldsymbol{w}, \boldsymbol{x}, b) = a(b - \boldsymbol{w}^\top (1-
\boldsymbol{x}))
\]</span> where <span class="math inline">\(x, y\)</span> are truth
values of atoms or sub-formulas, <span class="math inline">\(\boldsymbol{w}, b\)</span> are connection weights
and bias of the neural net, and <span class="math inline">\(a:\mathbb{R}
\rightarrow [0,1]\)</span> is the activation function of that neuron.
<span class="math inline">\(a\)</span> could be any function that map
the linear combination to the unit interval, and should satisfy the
property <span class="math inline">\(a(1-x)=1-a(x)\)</span>. In the
paper, the authors simply defined it as <span class="math inline">\(a(x)
= max\{0,min\{1,x\}\}\)</span>. According to the De Morgan laws, the
logical implication is derived as:</p><p><span class="math display">\[
→(w_x,x,w_y,y,b) = a(1-b+w_x(1-x)+w_yy)
\]</span></p><p>With these key ideas of LNN in mind, how can we use LNN to address
our central question<span class="math inline">\(\phi_1^{X_1},\dots,\phi_n^{X_n}|\!\!\!\approx
\psi^Y\)</span>​? Let’s walk through the simple <em>modus ponens</em>
example. Consider the below 3 sentences:</p><p><span class="math display">\[
\begin{align*}
& \phi_1 = P \\
& \phi_2 = P \implies Q \\
& \phi_3 = Q\end{align*}
\]</span></p><p>The problem is, what is <span class="math inline">\(Pr(\phi_3)\)</span>, given <span class="math inline">\(Pr(\phi_1), Pr(\phi_2)\)</span>? From the
perspective of LNN, the problem can be framed as “given <span class="math inline">\(x_{\phi_1}\)</span> and <span class="math inline">\(z_{\phi_2}\)</span>, infer <span class="math inline">\(y_{\phi_3}\)</span>”:</p><figure><img src=https://qige96.github.io/myblog/images/LNN-example2.png alt="LNN example 2"><figcaption aria-hidden=true>LNN example 2</figcaption></figure><p>therefore, the problem is equivalent to solve the below equation with
<span class="math inline">\(y_{\phi_2}\)</span> as the only unknown
<span class="math display">\[
z_{\phi_2} = a(1-b+w_x(1-x_{\phi_1})+w_yy_{\phi_2})
\]</span> where <span class="math inline">\(z_{\phi_2}=Pr(\phi_2),
x_{\phi_1}=Pr(\phi_1)\)</span>, <span class="math inline">\(a(·)\)</span> is the user selected activation
function, and <span class="math inline">\(w_{x}, w_{y}, b\)</span> are
network parameters learnt from training data. How to learn the weights
and bias is out of the scope of our consideration, but interested
readers can learn more from the LNN paper<a href=#fn3 class=footnote-ref id=fnref3 role=doc-noteref><sup>3</sup></a>.</p><p>One more thing to note is that, here we only assign one single real
value to the logical formula to describe their truth. Yet in the LNN
paper, truth value of logical formulas are described by lower and upper
bounds, i.e., a real-value interval, and all the neurons take as input
pairs of values and output a pair of bounds. The authors claimed that an
elegant representation of uncertainty in light of the open-world
assumption, e.g., explicitly initializing unknown facts with lower bound
<span class="math inline">\(L = 0\)</span> and upper bound <span class="math inline">\(U = 1\)</span>.</p><section id=footnotes class="footnotes footnotes-end-of-document" role=doc-endnotes><hr><ol><li id=fn1><p>Riegel, R., Gray, A., Luus, F., Khan, N., Makondo, N.,
Akhalwaya, I. Y., … & Srivastava, S. (2020). Logical neural
networks. <em>arXiv preprint arXiv:2006.13155</em>.<a href=#fnref1 class=footnote-back role=doc-backlink>↩︎</a></p></li><li id=fn2><p>Riegel, R., Gray, A., Luus, F., Khan, N., Makondo, N.,
Akhalwaya, I. Y., … & Srivastava, S. (2020). Logical neural
networks. <em>arXiv preprint arXiv:2006.13155</em>.<a href=#fnref2 class=footnote-back role=doc-backlink>↩︎</a></p></li><li id=fn3><p>Riegel, R., Gray, A., Luus, F., Khan, N., Makondo, N.,
Akhalwaya, I. Y., … & Srivastava, S. (2020). Logical neural
networks. <em>arXiv preprint arXiv:2006.13155</em>.<a href=#fnref3 class=footnote-back role=doc-backlink>↩︎</a></p></li></ol></section></div><div class="row middle-xs"><div class=col-xs-12></div></div><div class=row><div class=col-xs-12><a rel=license href=http://creativecommons.org/licenses/by-nc-nd/4.0/><img alt="Creative Commons License" style=border-width:0 src=https://upload.wikimedia.org/wikipedia/commons/7/73/Cc_by-nc-nd_icon.svg></a></div></div><div style=height:50px></div><div class=site-footer></div></div></div></article><script></script></body></html>